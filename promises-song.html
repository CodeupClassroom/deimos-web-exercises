<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Promises Song</title>
</head>
<body>

<h1>A Song of Promises</h1>

<h3 id="song"></h3>

<button id="sing-btn">Sing</button>

<script>
    "use strict";
    const song = document.getElementById('song');
    // A Song from Callback Hell...

    function singLyrics(lyrics, pitch, callback) {
        var lyric = new SpeechSynthesisUtterance(lyrics);
        lyric.pitch = pitch;
        lyric.rate = .7;
        speechSynthesis.speak(lyric);
        song.append(lyrics);
        setTimeout(callback, 1500);
    }

    const sing = () => {
        song.innerHTML = "";
        singLyrics('All a-', .5, function() {
            singLyrics('round the', 1, function() {
                singLyrics(' mulberry', 1.5, function() {
                    singLyrics(' bush', 1, function() {
                        singLyrics(' the monkey', .5, function() {
                            singLyrics(' chased', 1, function() {
                                singLyrics(' the wea-', 1.5, function() {
                                    singLyrics(' sel', 1, function() {
                                        return false;
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    };

    // A Simpler Song to Read (I promise)... but still sung terribly...

    function singLyricsPromises(lyrics, pitch) {
        return new Promise((res) => {
            var lyric = new SpeechSynthesisUtterance(lyrics);
            lyric.pitch = pitch;
            lyric.rate = .7;
            speechSynthesis.speak(lyric);
            song.append(lyrics);
            setTimeout(res, 1500);
        });
    }

    const singPromises = () => {
        song.innerHTML = "";
        return singLyricsPromises('All a-', .5)
            .then(() => singLyricsPromises('round the', 1))
            .then(() => singLyricsPromises(' mulberry', 1.5))
            .then(() => singLyricsPromises(' bush', 1))
            .then(() => singLyricsPromises(' the monkey', .5))
            .then(() => singLyricsPromises(' chased', 1))
            .then(() => singLyricsPromises(' the wea-', 1.5))
            .then(() => singLyricsPromises(' sel', 1));
    };

    function singLyricsOffspring(lyrics, pitch) {
        return new Promise((res) => {
            var lyric = new SpeechSynthesisUtterance(lyrics);
            lyric.pitch = pitch;
            lyric.rate = .5;
            speechSynthesis.speak(lyric);
            song.append(lyrics);
            setTimeout(res, 1900);
        });
    }

    const singOffspring = () => {
        song.innerHTML = "";
        return singLyricsOffspring('Have you ever', 1)
            .then(() => singLyricsOffspring(' walked ', 1.2))
            .then(() => singLyricsOffspring(' through a room', 1))
            .then(() => singLyricsOffspring(' but it was more like', .9))
            .then(() => singLyricsOffspring(' the room', 1.1))
            .then(() => singLyricsOffspring(' passed around you', 1.2))
            .then(() => singLyricsOffspring(' like there was a', 1))
            .then(() => singLyricsOffspring(' leash around your neck', 1.3))
            .then(() => singLyricsOffspring(' that pulled you through.', 1.5))
    };

    document.getElementById('sing-btn').addEventListener('click', singPromises);
</script>

</body>
</html>